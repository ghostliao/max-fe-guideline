# 性能优化

### 静态资源域名

静态资源使用不同域名进行引用

```html
<!-- http://maxjia.com/index -->
<img src="//cdn.max-c.com/logo.png" alt="" >
```

原因分析：

**浏览器并发请求数的限制**

我们进行网站页面访问时的客户端是浏览器，浏览器的很多机制对网站的访问速度有很大的影响（例如浏览器对静态资源的缓存机制），此外浏览器为提升页面显示效率，支持并发获取资源。参考：[不同浏览器的版本对并发的支持](http://www.stevesouders.com/blog/2008/03/20/roundup-on-parallel-connections/)

浏览器对并发请求的数目限制是针对域名的，即针对同一域名（包括二级域名）在同一时间支持的并发请求数量的限制。如果请求数目超出限制，则会阻塞。因此，网站中对一些静态资源，使用不同的一级域名，可以提升浏览器并行请求的数目，加速界面资源的获取速度。

**网络请求时cookie传输**

当静态资源与主服务在同一域名下（根据业务需要，主服务请求时需要传递cookie信息），每次静态资源的请求，都会发送同域名下的cookie。而对于静态资源，服务器无需对cookie进行任何处理，它们只是在毫无意义的消耗带宽。

假设网站cookie信息有1 KB、网站首页共150个资源时，用户在请求过程中需要发送150 KB的cookie信息，在512 Kbps的常见上行带宽下，需要长达3秒左右才能全部发送完毕。很多情况下cookie的path是在整个一级域名下可用的，如果你把静态资源设置成二级域名，那么它也避免不了cookie。例如如果给 http://maxjia.com 设置了cookie，那么会感染所有子域名, 请求 http://www.maxjia.com/logo.png 或者 http://image.maxjia.com/logo.png 时便会带上讨厌的cookie。

所以对于静态资源使用单独的域名，并设置为无cookie，以减少请求大小，提高网页性能。

**方便分流或缓存**

我们知道，当面对高并发访问时，在服务端会有相应的缓存机制，例如我们会在CDN中缓存一些静态资源，以便用户可以通过就近的网络节点获取资源。此外，独立的域名也方便我们在代理服务层做动静分离，以便提升静态请求的处理速度。

### 


